{"version":3,"sources":["/Users/gziolo/PhpstormProjects/gutenberg/packages/data/src/components/with-dispatch/index.js"],"names":["withDispatch","mapDispatchToProps","pure","WrappedComponent","ComponentWithDispatch","props","arguments","proxyProps","setProxyProps","propName","args","registry","dispatch","ownProps","propsToDispatchers","dispatcher","hasOwnProperty","proxyDispatch","bind","Component"],"mappings":";;;;;;;;;AAQA;;;;;;;;;;;;;;AALA;;AAMA;;AAKA;;AAdA;;;;AAKA;;;;AAMA;;;;AAKA;;;;;;;;;;;;AAYA,IAAMA,YAAY,GAAG,SAAfA,YAAe,CAAEC,kBAAF;AAAA,SAA0B,yCAC9C,sBAAS,CACRC,aADQ,EAER,UAAEC,gBAAF,EAAwB;AACvB,QAAMC,qBAAqB,GAAG,kCAAqB,UAArB;AAAA;AAAA;AAAA;;AAC7B,sBAAaC,KAAb,EAAqB;AAAA;;AAAA;AACpB,iHAAUC,SAAV;AAEA,cAAKC,UAAL,GAAkB,EAAlB;;AACA,cAAKC,aAAL,CAAoBH,KAApB;;AAJoB;AAKpB;;AAN4B;AAAA;AAAA,6CAQR;AACpB,eAAKG,aAAL,CAAoB,KAAKH,KAAzB;AACA;AAV4B;AAAA;AAAA,sCAYdI,QAZc,EAYM;AAAA;;AAAA,4CAAPC,IAAO;AAAPA,YAAAA,IAAO;AAAA;;AAClC;AACA,iCAAAT,kBAAkB,CAAE,KAAKI,KAAL,CAAWM,QAAX,CAAoBC,QAAtB,EAAgC,KAAKP,KAAL,CAAWQ,QAA3C,CAAlB,EAAyEJ,QAAzE,6BAAwFC,IAAxF;AACA;AAf4B;AAAA;AAAA,sCAiBdL,KAjBc,EAiBN;AAAA;;AACtB;AACA;AACA,cAAMS,kBAAkB,GAAGb,kBAAkB,CAAE,KAAKI,KAAL,CAAWM,QAAX,CAAoBC,QAAtB,EAAgCP,KAAK,CAACQ,QAAtC,CAA7C;AACA,eAAKN,UAAL,GAAkB,uBAAWO,kBAAX,EAA+B,UAAEC,UAAF,EAAcN,QAAd,EAA4B;AAC5E;AACA;AACA;AACA,gBAAK,MAAI,CAACF,UAAL,CAAgBS,cAAhB,CAAgCP,QAAhC,CAAL,EAAkD;AACjD,qBAAO,MAAI,CAACF,UAAL,CAAiBE,QAAjB,CAAP;AACA;;AAED,mBAAO,MAAI,CAACQ,aAAL,CAAmBC,IAAnB,CAAyB,MAAzB,EAA+BT,QAA/B,CAAP;AACA,WATiB,CAAlB;AAUA;AA/B4B;AAAA;AAAA,iCAiCpB;AACR,iBAAO,4BAAC,gBAAD,6BAAuB,KAAKJ,KAAL,CAAWQ,QAAlC,EAAkD,KAAKN,UAAvD,EAAP;AACA;AAnC4B;AAAA;AAAA,MAAiDY,kBAAjD,EAA9B;AAsCA,WAAO,UAAEN,QAAF;AAAA,aACN,4BAAC,kCAAD,QACG,UAAEF,QAAF;AAAA,eACD,4BAAC,qBAAD;AACC,UAAA,QAAQ,EAAGE,QADZ;AAEC,UAAA,QAAQ,EAAGF;AAFZ,UADC;AAAA,OADH,CADM;AAAA,KAAP;AAUA,GAnDO,CAAT,CAD8C,EAsD9C,cAtD8C,CAA1B;AAAA,CAArB;;eAyDeX,Y","sourcesContent":["/**\n * External dependencies\n */\nimport { mapValues } from 'lodash';\n\n/**\n * WordPress dependencies\n */\nimport { Component } from '@wordpress/element';\nimport { pure, compose, remountOnPropChange, createHigherOrderComponent } from '@wordpress/compose';\n\n/**\n * Internal dependencies\n */\nimport { RegistryConsumer } from '../registry-provider';\n\n/**\n * Higher-order component used to add dispatch props using registered action\n * creators.\n *\n * @param {Object} mapDispatchToProps Object of prop names where value is a\n *                                    dispatch-bound action creator, or a\n *                                    function to be called with with the\n *                                    component's props and returning an\n *                                    action creator.\n *\n * @return {Component} Enhanced component with merged dispatcher props.\n */\nconst withDispatch = ( mapDispatchToProps ) => createHigherOrderComponent(\n\tcompose( [\n\t\tpure,\n\t\t( WrappedComponent ) => {\n\t\t\tconst ComponentWithDispatch = remountOnPropChange( 'registry' )( class extends Component {\n\t\t\t\tconstructor( props ) {\n\t\t\t\t\tsuper( ...arguments );\n\n\t\t\t\t\tthis.proxyProps = {};\n\t\t\t\t\tthis.setProxyProps( props );\n\t\t\t\t}\n\n\t\t\t\tcomponentDidUpdate() {\n\t\t\t\t\tthis.setProxyProps( this.props );\n\t\t\t\t}\n\n\t\t\t\tproxyDispatch( propName, ...args ) {\n\t\t\t\t\t// Original dispatcher is a pre-bound (dispatching) action creator.\n\t\t\t\t\tmapDispatchToProps( this.props.registry.dispatch, this.props.ownProps )[ propName ]( ...args );\n\t\t\t\t}\n\n\t\t\t\tsetProxyProps( props ) {\n\t\t\t\t\t// Assign as instance property so that in reconciling subsequent\n\t\t\t\t\t// renders, the assigned prop values are referentially equal.\n\t\t\t\t\tconst propsToDispatchers = mapDispatchToProps( this.props.registry.dispatch, props.ownProps );\n\t\t\t\t\tthis.proxyProps = mapValues( propsToDispatchers, ( dispatcher, propName ) => {\n\t\t\t\t\t\t// Prebind with prop name so we have reference to the original\n\t\t\t\t\t\t// dispatcher to invoke. Track between re-renders to avoid\n\t\t\t\t\t\t// creating new function references every render.\n\t\t\t\t\t\tif ( this.proxyProps.hasOwnProperty( propName ) ) {\n\t\t\t\t\t\t\treturn this.proxyProps[ propName ];\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\treturn this.proxyDispatch.bind( this, propName );\n\t\t\t\t\t} );\n\t\t\t\t}\n\n\t\t\t\trender() {\n\t\t\t\t\treturn <WrappedComponent { ...this.props.ownProps } { ...this.proxyProps } />;\n\t\t\t\t}\n\t\t\t} );\n\n\t\t\treturn ( ownProps ) => (\n\t\t\t\t<RegistryConsumer>\n\t\t\t\t\t{ ( registry ) => (\n\t\t\t\t\t\t<ComponentWithDispatch\n\t\t\t\t\t\t\townProps={ ownProps }\n\t\t\t\t\t\t\tregistry={ registry }\n\t\t\t\t\t\t/>\n\t\t\t\t\t) }\n\t\t\t\t</RegistryConsumer>\n\t\t\t);\n\t\t},\n\t] ),\n\t'withDispatch'\n);\n\nexport default withDispatch;\n"]}